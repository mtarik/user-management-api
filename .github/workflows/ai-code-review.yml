# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
# ğŸ“ Workflow de Revue de Code IA v3.0 - Appelle le workflow centralisÃ©
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
#
# âœ¨ FonctionnalitÃ©s v3.0 :
# - ğŸ“Š Scoring dÃ©taillÃ© par catÃ©gorie (/10 avec quality labels)
# - ğŸ”’ Analyse OWASP Top 10 2021 structurÃ©e
# - ğŸ—ï¸ Analyse architecturale approfondie (patterns, violations, couplage)
# - âš¡ Optimisations performance dÃ©taillÃ©es (N+1, caching, complexitÃ©)
# - ğŸ·ï¸ Auto-labelling automatique basÃ© sur l'analyse
# - ğŸš¨ SystÃ¨me de gates (fail-on-critical) pour bloquer les merges
# - ğŸ“ˆ Tracking des mÃ©triques et tendances
#
# â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

name: ğŸ¤– AI Code Review v3.0

on:
  # Se dÃ©clenche sur les Pull Requests
  pull_request:
    types: [opened, synchronize, reopened]
    paths:
      - '**.java'

  # Se dÃ©clenche sur les commits sur ces branches
  push:
    branches:
      - main
      - develop
      - 'feature/**'
      - 'feat/**'
      - 'hotfix/**'
    paths:
      - '**.java'

  # Permet le dÃ©clenchement manuel
  workflow_dispatch:

jobs:
  ai-code-review:
    name: ğŸ“Š Revue de Code IA v3.0
    permissions:
      contents: read
      pull-requests: write
      issues: write
    uses: mtarik/java-ai-code-review/.github/workflows/reusable-ai-review.yml@main

    with:
      # Version de Java (17, 11, 8, etc.)
      java-version: '17'

      # Outil de build: 'auto', 'maven', ou 'gradle'
      build-tool: 'auto'

      # Activer les analyses statiques (Checkstyle, PMD)
      enable-static-analysis: true

      # Poster un commentaire sur la Pull Request avec analyse complÃ¨te
      post-pr-comment: true

      # âš ï¸ IMPORTANT: Bloquer le merge si des problÃ¨mes critiques sont dÃ©tectÃ©s
      # Mettre Ã  true aprÃ¨s validation de la configuration
      fail-on-critical: false

    secrets:
      # La clÃ© API Anthropic doit Ãªtre configurÃ©e dans les secrets du repository
      # Settings â†’ Secrets and variables â†’ Actions â†’ New repository secret
      # Nom: ANTHROPIC_API_KEY
      ANTHROPIC_API_KEY: ${{ secrets.ANTHROPIC_API_KEY }}
